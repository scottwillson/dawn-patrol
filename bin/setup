#!/bin/bash
set -e

if [ "$(uname)" == "Darwin" ]; then
  brew --version >/dev/null 2>&1 || { echo "Install Homebrew or docker and git manually"; exit 1;}
  docker-compose -v >/dev/null 2>&1 || { brew install docker-compose; }
elif [ "$(expr substr $(uname -s) 1 5)" == "Linux" ]; then
  docker-compose -v >/dev/null 2>&1 || { sudo apt-get -y install docker-compose; }
fi

./bin/test
docker-compose stop
docker-compose -f docker-compose/development.yml --project-dir . up --build
