#!/bin/bash
set -e

if [ "$(uname)" == "Darwin" ]; then
  brew --version >/dev/null 2>&1 || { echo "Install Homebrew or docker and git manually"; exit 1;}
  docker-compose -v >/dev/null 2>&1 || { brew install docker-compose; }
elif [ "$(expr substr $(uname -s) 1 5)" == "Linux" ]; then
  docker-compose -v >/dev/null 2>&1 || { sudo apt-get -y install docker-compose; }
fi

# go get -tags 'nosqlite3 nomymysql nomysql' github.com/steinbacher/goose/cmd/goose github.com/jinzhu/gorm

# ( cd db && bin/create_development_databases )
# ( cd api && bin/migrate_databases )
#
# ( cd api && \
#   go clean ./... && \
#   go build ./...
# )
#
# ( cd web && yarn && yarn build )
#
# docker-compose stop
# docker-compose up -d --build
#
# gem install bundler
# bundle
#
# ./bin/test
#
# docker-compose stop
